---
import {
  SPEC_MAP as SPEC_MAP_CANON,
  SPEC_ICON_MAP as SPEC_ICON_MAP_CANON,
} from "../lib/wow-constants.ts";

export interface Props {
  specId?: number;
  className?: string;
  specName?: string;
  size?: number;
  class?: string;
}

const { specId, className, specName, size = 16, class: cssClass } = Astro.props;

// determine class and spec from either specId or direct props
let finalClass = className;
let finalSpec = specName;

if (specId && SPEC_MAP_CANON[specId as keyof typeof SPEC_MAP_CANON]) {
  const specInfo = SPEC_MAP_CANON[specId as keyof typeof SPEC_MAP_CANON] as {
    role: string;
    class: string;
    spec: string;
  };
  finalClass = specInfo.class;
  finalSpec = specInfo.spec;
}

// get the icon URL
const iconKey = `${finalClass}|${finalSpec}`;
const iconUrl = SPEC_ICON_MAP_CANON[iconKey];
---

{
  iconUrl && (
    <img
      src={iconUrl}
      alt={`${finalSpec} ${finalClass}`}
      class={`spec-icon ${cssClass || ""}`.trim()}
      width={size}
      height={size}
      style={`border-radius: 2px;`}
    />
  )
}

<style>
  .spec-icon {
    flex-shrink: 0;
    vertical-align: middle;
  }
</style>
