---
import LoadingState from "../LoadingState.astro";

export interface Props {
  region?: string;
  realmSlug?: string;
  playerName?: string;
  class?: string;
}

const {
  region = "",
  realmSlug = "",
  playerName = "",
  class: className,
} = Astro.props;
---

<div
  class={`player-profile-container ${className || ""}`.trim()}
  data-region={region}
  data-realm={realmSlug}
  data-player={playerName}
>
  <!-- Loading State (shown by default) -->
  <div id="profile-loading" class="profile-state">
    <LoadingState message="Loading player profile..." />
  </div>

  <!-- Error State (hidden by default) -->
  <div id="profile-error" class="profile-state" style="display: none;">
    <LoadingState type="error" message="Player not found" />
    <div class="debug-info" style="display: none;">
      <!-- Debug info will be populated by client-side script -->
    </div>
  </div>

  <!-- Profile Content (hidden by default, populated by client-side) -->
  <div id="profile-content" style="display: none;">
    <!-- Content will be populated by client-side JavaScript -->
  </div>
</div>

<script src="../../client/player-profile.ts"></script>
<script type="module">
  console.debug("[PlayerProfile.astro] module import requested");
</script>

<style>
  .player-profile-container {
    width: 100%;
  }

  .profile-state {
    min-height: 200px;
  }

  .debug-info {
    background: #333;
    color: #fff;
    padding: 10px;
    margin: 10px 0;
    font-family: monospace;
    font-size: 12px;
    border-radius: 4px;
  }

  .debug-info div {
    margin: 4px 0;
  }

  /* Profile content styling */
  #profile-content .player-header {
    background-color: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 24px;
    margin-bottom: 24px;
    display: flex;
    align-items: center;
    gap: 20px;
  }

  #profile-content .player-avatar {
    width: 80px;
    height: 80px;
    border-radius: 8px;
    border: 2px solid var(--border-color);
  }

  #profile-content .player-info h2 {
    color: var(--text-primary);
    margin: 0 0 8px 0;
    font-size: 1.8em;
  }

  #profile-content .player-details {
    color: var(--text-secondary);
    font-size: 1em;
  }

  #profile-content .equipment-section {
    background-color: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 24px;
    margin-bottom: 24px;
  }

  #profile-content .equipment-section h3 {
    color: var(--text-primary);
    margin: 0 0 16px 0;
    font-size: 1.4em;
  }

  #profile-content .best-runs-section {
    background-color: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 24px;
  }

  #profile-content .best-runs-section h3 {
    color: var(--text-primary);
    margin: 0 0 16px 0;
    font-size: 1.4em;
  }
</style>